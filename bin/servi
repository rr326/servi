#!/usr/bin/env bash
# Simple script to run servi from your working directory


# http://unix.stackexchange.com/questions/13464/is-there-a-way-to-find-a-file-in-an-inverse-recursive-search
function upsearch () {
    test / == "$PWD" && return 1 || test -e "$1" && return 0 || cd .. && upsearch "$1"
}


if ! hash python3 2>/dev/null
then
    echo
    echo "**************************************************"
    echo "python3 not found on path (try: 'which python3')."
    echo "python3 must be installed for servi to work."
    echo "Aborting"
    echo "**************************************************"
    echo
    exit 1
else
    if ! upsearch "servi"
    then
        echo
        echo "****************************************************"
        echo "'servi' directory not found above current directory."
        echo "Aborting"
        echo "****************************************************"
        echo        
        exit 1    
    else
        # Try one more level up, just in case you are within servi/servi/**
        cwd=`pwd`
        cd ..
        if [[ ! -e servi ]]
        then
            cd $cwd
        fi
        
        python3 servi/servi $*
    fi
fi

